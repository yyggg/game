import{D as J,_ as O}from"./darkSwitch-Cp_xuZFu.js";import{i as j,e as V,m as h,W as q,o as a,h as S,X as P,Y as F,s as t,Z as R,N as l,O as r,V as M,U as b,T as f,l as p,_ as T,M as K,$ as X,a as Q,a0 as Z,k as w,n as ee}from"./vue-CwFJaX1P.js";import{d as ne,r as te,b as G,u as B,a as H,c as oe,s as ae,_ as A,e as se,f as re,g as le,l as ie,h as ue}from"./index-PFvgZIwd.js";import{h as ce,o as W}from"./router-BFGAnl3B.js";import{t as de}from"./useDark-CslD6zNB.js";const me="/api/index/";function fe($,y){ne(()=>{if(te.currentRoute.value.meta.initialize===!1)return;const u=G(),s=B();if(!u.isLogin()&&s.initialize||u.isLogin()&&s.userInitialize)return;const d=H();oe({url:me+"index",method:"get",params:{requiredLogin:y?1:0}}).then(n=>{ce(n.data.rules,n.data.menus),s.dataFill(n.data.site),d.setStatus(n.data.openMemberCenter),j(n.data.userInfo)||(n.data.userInfo.refresh_token=u.getToken("refresh"),u.dataFill(n.data.userInfo),s.setUserInitialize(!0)),n.data.openMemberCenter||d.setLayoutMode("Disable"),s.setInitialize(!0),ae(),typeof $=="function"&&$(n)})},200)()}const pe=V({__name:"menuSub",props:{menus:{default:()=>[]},showIcon:{type:Boolean,default:!1}},setup($){const y=$,u=s=>{var d;s.path=="/"||((d=s.meta)==null?void 0:d.type)=="menu_dir"||W(s)};return(s,d)=>{const n=h("Icon"),v=h("el-sub-menu"),U=h("el-menu-item"),g=q("blur");return a(!0),S(F,null,P(y.menus,(c,L)=>{var x,C;return a(),S(F,{key:L},[t(j)(c.children)?R((a(),l(U,{key:1,onClick:m=>t(W)(c),index:"column-"+((C=c.meta)==null?void 0:C.id),class:T(c.name.replace(/[\/]/g,"-"))},{title:r(()=>{var m;return[b(f((m=c.meta)==null?void 0:m.title),1)]}),default:r(()=>{var m;return[s.showIcon?(a(),l(n,{key:0,name:(m=c.meta)==null?void 0:m.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):M("",!0)]}),_:2},1032,["onClick","index","class"])),[[g]]):R((a(),l(v,{key:0,onClick:m=>u(c),index:`column-${(x=c.meta)==null?void 0:x.id}`},{title:r(()=>{var m,D;return[s.showIcon?(a(),l(n,{key:0,name:(m=c.meta)==null?void 0:m.icon,color:"var(--el-text-color-primary)"},null,8,["name"])):M("",!0),b(" "+f((D=c.meta)==null?void 0:D.title),1)]}),default:r(()=>[p(E,{menus:c.children,"show-icon":s.showIcon},null,8,["menus","show-icon"])]),_:2},1032,["onClick","index"])),[[g]])],64)}),128)}}}),E=A(pe,[["__scopeId","data-v-46fce36e"]]),he={class:"header-user-box"},_e=["src"],ve=V({__name:"menu",props:{showIcon:{type:Boolean,default:!1}},setup($){const y=K(),u=X(),s=se(),d=G(),n=B(),v=H(),U=$,g=Q({activeMenu:""}),c=e=>{if(e.path=="/")return g.activeMenu="index";const o=D(e);o?g.activeMenu="column-"+o:e.path.startsWith("/user")&&(g.activeMenu="user")},L=e=>{if(x(n.headNav,e)||x(v.state.navUserMenus,e)||x(v.state.viewRoutes,e)){const o=g.activeMenu;g.activeMenu="",ee(()=>{g.activeMenu=o})}},x=(e,o)=>o.indexOf("language-switch")===0||o=="theme-switch"?!0:C(e,o),C=(e,o)=>{var i,k,N;for(const _ in e){if(`column-${(i=e[_].meta)==null?void 0:i.id}`==o)return((k=e[_].meta)==null?void 0:k.menu_type)=="link";if((N=e[_].children)!=null&&N.length)return C(e[_].children,o)}return!1},m=(e,o)=>{var k,N;let i=!1;for(const _ in e){if((k=e[_].meta)!=null&&k.id&&e[_].path==o.fullPath)return e[_].meta.id;if(e[_].children&&((N=e[_].children)!=null&&N.length)&&(i=m(e[_].children,o),i!==!1))return i}return i},D=e=>{const o=m(n.headNav,e);if(o!==!1)return o;const i=m(v.state.navUserMenus,e);return i!==!1?i:m(v.state.viewRoutes,e)};return c(y),Z(e=>{c(e)}),(e,o)=>{const i=h("Icon"),k=h("el-menu-item"),N=h("el-sub-menu"),_=h("el-menu"),z=q("blur");return a(),l(_,{ref_key:"layoutMenuRef",ref:ie,"default-active":g.activeMenu,onSelect:L},{default:r(()=>[R((a(),l(k,{onClick:o[0]||(o[0]=I=>t(u).push({name:"/"})),index:"index"},{title:r(()=>[b(f(e.$t("Home")),1)]),default:r(()=>[U.showIcon?(a(),l(i,{key:0,name:"fa fa-home",color:"var(--el-text-color-primary)"})):M("",!0)]),_:1})),[[z]]),p(E,{menus:t(n).headNav,"show-icon":e.showIcon},null,8,["menus","show-icon"]),t(v).state.open?(a(),S(F,{key:0},[t(d).isLogin()?R((a(),l(N,{key:0,onClick:o[3]||(o[3]=I=>e.$attrs.mode=="vertical"?"":t(u).push({name:"user"})),index:"user-box"},{title:r(()=>[w("div",he,[w("img",{class:T(["header-user-avatar",e.$attrs.mode=="vertical"?"icon-header-user-avatar":""]),src:t(re)(t(d).avatar?t(d).avatar:"/static/images/avatar.png"),alt:""},null,10,_e),b(" "+f(t(d).nickname),1)])]),default:r(()=>[R((a(),l(k,{onClick:o[1]||(o[1]=I=>t(u).push({name:"user"})),index:"user"},{default:r(()=>[e.showIcon?(a(),l(i,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):M("",!0),b(" "+f(e.$t("Member Center")),1)]),_:1})),[[z]]),p(E,{menus:t(v).state.navUserMenus,"show-icon":e.showIcon},null,8,["menus","show-icon"]),p(E,{menus:t(v).state.viewRoutes,"show-icon":e.showIcon},null,8,["menus","show-icon"]),R((a(),l(k,{onClick:o[2]||(o[2]=I=>t(d).logout()),index:"user-logout"},{default:r(()=>[e.showIcon?(a(),l(i,{key:0,name:"fa fa-sign-out",color:"var(--el-text-color-primary)"})):M("",!0),b(" "+f(e.$t("Logout login")),1)]),_:1})),[[z]])]),_:1})),[[z]]):R((a(),l(k,{key:1,onClick:o[4]||(o[4]=I=>t(u).push({name:"user"})),index:"user"},{default:r(()=>[e.showIcon?(a(),l(i,{key:0,name:"fa fa-user-circle",color:"var(--el-text-color-primary)"})):M("",!0),b(" "+f(e.$t("Member Center")),1)]),_:1})),[[z]]),R((a(),l(N,{index:"language-switch",class:"language-switch"},{title:r(()=>[e.showIcon?(a(),l(i,{key:0,name:"local-lang",color:"var(--el-text-color-primary)"})):M("",!0),b(" "+f(e.$t("Language")),1)]),default:r(()=>[(a(!0),S(F,null,P(t(s).lang.langArray,I=>(a(),l(k,{onClick:Me=>t(le)(I.name),key:I.name,index:"language-switch-"+I.value,class:"language-switch"},{default:r(()=>[e.showIcon?(a(),l(i,{key:0,name:"fa fa-circle-o",color:"var(--el-text-color-primary)"})):M("",!0),b(" "+f(I.value),1)]),_:2},1032,["onClick","index"]))),128))]),_:1})),[[z]]),p(k,{index:"theme-switch",class:T(["theme-switch",e.$attrs.mode+"-theme-switch"])},{default:r(()=>[p(J,{onClick:o[5]||(o[5]=I=>t(de)())})]),_:1},8,["class"])],64)):M("",!0)]),_:1},8,["default-active"])}}}),Y=A(ve,[["__scopeId","data-v-0f4fb637"]]),ge={class:"site-name"},ke={class:"header-row"},we={class:"site-name"},ye=V({__name:"header",setup($){const y=X(),u=B(),s=H();return Z(()=>{s.toggleMenuExpand(!1)}),fe(),(d,n)=>{const v=h("Icon"),U=h("el-scrollbar"),g=h("el-col"),c=h("el-row"),L=h("el-drawer"),x=h("el-header");return a(),l(x,{class:"header"},{default:r(()=>[p(c,{justify:"center"},{default:r(()=>[p(g,{class:"header-row",xs:24,sm:24,md:16},{default:r(()=>[w("div",{onClick:n[0]||(n[0]=C=>t(y).push({name:"/"})),class:"header-logo"},[n[5]||(n[5]=w("img",{src:O},null,-1)),w("span",ge,f(t(u).siteName),1)]),t(s).state.menuExpand?M("",!0):(a(),S("div",{key:0,onClick:n[1]||(n[1]=C=>t(s).toggleMenuExpand(!0)),class:"user-menus-expand hidden-md-and-up"},[p(v,{name:"fa fa-indent",color:"var(--el-color-primary)",size:"20"})])),p(U,{ref_key:"layoutMenuScrollbarRef",ref:ue,class:"hidden-sm-and-down"},{default:r(()=>[p(Y,{class:"frontend-header-menu",ellipsis:!1,mode:"horizontal"})]),_:1},512)]),_:1})]),_:1}),p(L,{class:"ba-aside-drawer","append-to-body":!0,modelValue:t(s).state.menuExpand,"onUpdate:modelValue":n[4]||(n[4]=C=>t(s).state.menuExpand=C),"with-header":!1,direction:"ltr",size:t(s).state.shrink?"70%":"40%"},{default:r(()=>[w("div",ke,[w("div",{onClick:n[2]||(n[2]=C=>t(y).push({name:"/"})),class:"header-logo"},[n[6]||(n[6]=w("img",{src:O},null,-1)),w("span",we,f(t(u).siteName),1)]),w("div",{onClick:n[3]||(n[3]=C=>t(s).toggleMenuExpand(!1)),class:"user-menus-expand hidden-md-and-up"},[p(v,{name:"fa fa-dedent",color:"var(--el-color-primary)",size:"20"})])]),p(Y,{"show-icon":!0,mode:"vertical"})]),_:1},8,["modelValue","size"])]),_:1})}}}),ze=A(ye,[["__scopeId","data-v-47a66cae"]]),Ce={href:"http://beian.miit.gov.cn/"},Ie=V({__name:"footer",setup($){const y=B();return(u,s)=>{const d=h("el-footer");return a(),l(d,{class:"footer"},{default:r(()=>[w("div",null,[b(" Copyright @ 2020~"+f(new Date().getFullYear())+" "+f(t(y).siteName)+" "+f(u.$t("Copyright"))+" ",1),w("a",Ce,f(t(y).recordNumber),1)])]),_:1})}}}),Ue=A(Ie,[["__scopeId","data-v-ff7303bf"]]);export{Ue as F,ze as H,fe as i};
